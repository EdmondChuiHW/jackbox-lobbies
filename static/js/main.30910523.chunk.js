(this["webpackJsonpjackbox-lobbies"]=this["webpackJsonpjackbox-lobbies"]||[]).push([[0],{54:function(e,t,n){e.exports=n(90)},59:function(e,t,n){},60:function(e,t,n){},90:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(13),o=n.n(c),u=(n(59),n(123)),i=(n(60),n(44)),s=n(30),l=n(6),m=n.n(l),f=n(9),p=n(12),h=n(124),d=n(125),v=n(118),b=n(117),g=n(126),w=n(115),x=Object(w.a)((function(e){return{formControl:{margin:e.spacing(3)}}}));function j(e){var t=e.names,n=e.selectedNames,r=e.onCheckboxChange,c=x();return a.a.createElement(a.a.Fragment,null,a.a.createElement(d.a,{component:"fieldset",className:c.formControl},a.a.createElement(g.a,{component:"legend"},"Games"),a.a.createElement(b.a,{row:!0},t.map((function(e){return a.a.createElement(v.a,{key:e,label:e,control:a.a.createElement(h.a,{checked:n.has(e),onChange:function(e){return r&&r(e.currentTarget)},name:e})})})))))}var O=n(127),E=n(128),k=n(120),y=n(122),A=n(121),C=n(91),S=n(119),P=n(29);Object(P.setLogging)(!0);var R=a.a.createContext();function _(e){var t=e.children,n=e.numWorkers,c=void 0===n?20:n,o=Object(r.useState)(),u=Object(p.a)(o,2),i=u[0],s=u[1],l=Object(r.useState)(0),h=Object(p.a)(l,2),d=h[0],v=h[1];return Object(r.useEffect)((function(){v(0);var e=Object(P.createScheduler)();return Object(f.a)(m.a.mark((function t(){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(Array(c).fill().map((function(){return Object(P.createWorker)()})).map(function(){var t=Object(f.a)(m.a.mark((function t(n){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.load();case 2:return t.next=4,n.loadLanguage("eng");case 4:return t.next=6,n.initialize("eng");case 6:return t.next=8,n.setParameters({tessjs_create_hocr:"0",tessjs_create_tsv:"0"});case 8:e.addWorker(n),v((function(e){return e+1}));case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 2:s(e);case 3:case"end":return t.stop()}}),t)})))(),function(){return e.terminate()}}),[c]),a.a.createElement(R.Provider,{value:i},i?t:a.a.createElement(a.a.Fragment,null,a.a.createElement(S.a,{maxWidth:"sm"},a.a.createElement(O.a,{value:d/c*100,variant:"determinate"}),a.a.createElement("img",{src:"/jackbox-lobbies/loading_workers.svg",alt:"Loading\u2026",width:"50%",style:{margin:16}}),a.a.createElement(C.a,{variant:"h6"},"Loading image recognition magic\u2026"))))}R.displayName="ImageTextRecognitionContext";var T=Object(w.a)((function(e){return{root:{margin:e.spacing(1)},media:{width:480,height:270}}}));function L(e){var t=e.stream,n=e.gameName,c=T(),o=function(e){var t=Object(r.useState)({}),n=Object(p.a)(t,2),a=n[0],c=n[1];return Object(r.useEffect)((function(){if(e){var t=!1;return Object(f.a)(m.a.mark((function n(){var r;return m.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,K(e);case 2:if(r=n.sent,!t){n.next=5;break}return n.abrupt("return");case 5:c(r);case 6:case"end":return n.stop()}}),n)})))(),function(){return t=!0}}}),[e]),a}(t.thumbnail_url),u=o.blob,i=o.imgSrc,s=function(e,t){var n=Object(r.useContext)(R),a=Object(r.useState)(),c=Object(p.a)(a,2),o=c[0],u=c[1];return Object(r.useEffect)((function(){if(n&&e){var r=!1;return Object(f.a)(m.a.mark((function a(){var c,o;return m.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,n.addJob("recognize",e,t);case 2:if(c=a.sent,o=c.data,!r){a.next=6;break}return a.abrupt("return");case 6:u(o);case 7:case"end":return a.stop()}}),a)})))(),function(){console.log("canceled"),r=!0}}}),[e,t,n]),o}(u),l=!s,h=null===s||void 0===s?void 0:s.lines.some((function(e){return e.text.match(/everybody|to start|same players|room|on your/i)}));if(!l&&!h)return a.a.createElement(a.a.Fragment,null);var d="https://twitch.tv/".concat(t.user_name.toLowerCase());return a.a.createElement(a.a.Fragment,null,a.a.createElement(E.a,{className:c.root,style:{opacity:h?1:.3,order:h?0:1}},a.a.createElement(k.a,{href:d,target:"_blank",rel:"noopener noreferrer"},a.a.createElement(A.a,{className:c.media,image:i||"https://via.placeholder.com/480x270?text=%E2%80%A6",title:"Click to watch ".concat(t.user_name," on Twitch")}),l&&a.a.createElement(O.a,null),a.a.createElement(y.a,{style:{display:"flex",flexDirection:"row"}},a.a.createElement(C.a,{variant:"body1",color:"textSecondary",component:"span"},n||t.user_name),a.a.createElement("span",{style:{flex:1}}),a.a.createElement(C.a,{variant:"body1",color:"textSecondary",component:"span"},"watching now: ",t.viewer_count)))))}function K(e){return N.apply(this,arguments)}function N(){return(N=Object(f.a)(m.a.mark((function e(t){var n,r,a,c,o,u,i,s=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:1920,r=s.length>2&&void 0!==s[2]?s[2]:1080,a=s.length>3&&void 0!==s[3]?s[3]:0,c=t.replace("{width}",n).replace("{height}",r),e.next=6,fetch(c,{cache:"reload"});case 6:if(o=e.sent,!(U(o.headers)>20&&a<8)){e.next=10;break}return e.abrupt("return",K(t,n+1,r,a+1));case 10:return e.next=12,o.blob();case 12:return u=e.sent,i=window.URL.createObjectURL(u),e.abrupt("return",{blob:u,imgSrc:i});case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e){var t=1e3*function(e){var t=e.get("cache-control");if(!t)return 300;var n=new URLSearchParams(t).get("max-age");return n?+n:300}(e),n=new Date(e.get("expires")||Date.now()).getTime()-t;return(Date.now()-n)/1e3}var B=function(e){var t="",n=function(){return{"Client-ID":e,Authorization:"Bearer ".concat(t)}};return{getStreams:function(e,t){var r=this;return Object(f.a)(m.a.mark((function a(){var c,o,u,i,s;return m.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return c=new URLSearchParams,e.forEach((function(e){return c.append("game_id",e)})),c.append("first","100"),t&&c.append("after",t),a.next=6,fetch("https://api.twitch.tv/helix/streams?"+c,{headers:n()});case 6:return o=a.sent,a.next=9,o.json();case 9:return u=a.sent,i=u.data,s=u.pagination,a.abrupt("return",{streams:i,fetchNext:function(){var t=Object(f.a)(m.a.mark((function t(){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r.getStreams(e,s.cursor));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()});case 13:case"end":return a.stop()}}),a)})))()},getGames:function(e){return Object(f.a)(m.a.mark((function t(){var r,a,c,o;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=new URLSearchParams,e.forEach((function(e){return r.append("name",e)})),t.next=4,fetch("https://api.twitch.tv/helix/games?"+r,{headers:n()});case 4:return a=t.sent,t.next=7,a.json();case 7:return c=t.sent,o=c.data,t.abrupt("return",o||[]);case 10:case"end":return t.stop()}}),t)})))()},getAuthUrl:function(){var t=new URLSearchParams;return t.append("client_id",e),t.append("redirect_uri",window.location.origin+window.location.pathname),t.append("response_type","token"),t.append("scope",""),"https://id.twitch.tv/oauth2/authorize?"+t},handleAuthResponse:function(){var e=new URLSearchParams(window.location.hash.slice(1)).get("access_token");e&&(t=e)},hasAuth:function(){return!!t}}},J=a.a.createContext({twitchApi:B("r2000vj19f088smr120ej452wxlkrt")});function W(){var e=Object(r.useContext)(J).twitchApi;return e.handleAuthResponse(),e}var z=["DRAWFUL 2","THE JACKBOX PARTY PACK","THE JACKBOX PARTY PACK 2","THE JACKBOX PARTY PACK 3","THE JACKBOX PARTY PACK 4","THE JACKBOX PARTY PACK 5","THE JACKBOX PARTY PACK 6"];function H(){var e=W(),t=Object(r.useState)(new Set([])),n=Object(p.a)(t,2),c=n[0],o=n[1],i=Object(r.useState)([]),l=Object(p.a)(i,2),h=l[0],d=l[1],v=Object(r.useState)(new Map),b=Object(p.a)(v,2),g=b[0],w=b[1],x=Object(r.useState)([]),O=Object(p.a)(x,2),E=O[0],k=O[1],y=Object(r.useState)((function(){return function(){}})),A=Object(p.a)(y,2),C=A[0],S=A[1];return Object(r.useEffect)((function(){if(!c.size)return d([]),void w(new Map);var t=!1;return Object(f.a)(m.a.mark((function n(){var r;return m.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.getGames(c);case 2:if(r=n.sent,!t){n.next=5;break}return n.abrupt("return");case 5:d(r),w(new Map(r.map((function(e){return[e.id,e.name]}))));case 7:case"end":return n.stop()}}),n)})))(),function(){return t=!0}}),[e,c]),Object(r.useEffect)((function(){if(!h.length)return k([]),void S((function(){return function(){}}));var t=!1;function n(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];k(t?function(t){return M([].concat(Object(s.a)(t),Object(s.a)(e.streams)))}:e.streams),S((function(){return Object(f.a)(m.a.mark((function t(){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=n,t.next=3,e.fetchNext();case 3:return t.t1=t.sent,t.abrupt("return",(0,t.t0)(t.t1,!0));case 5:case"end":return t.stop()}}),t)})))}))}return Object(f.a)(m.a.mark((function r(){var a;return m.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.getStreams(h.map((function(e){return e.id})));case 2:if(a=r.sent,!t){r.next=5;break}return r.abrupt("return");case 5:n(a);case 6:case"end":return r.stop()}}),r)})))(),function(){return t=!0}}),[e,h]),a.a.createElement(a.a.Fragment,null,a.a.createElement(_,null,a.a.createElement(j,{names:z,selectedNames:c,onCheckboxChange:function(e){var t=e.name,n=e.checked;o((function(e){var r=new Set(e);return n?r.add(t):r.delete(t),r}))}}),a.a.createElement("div",null,"Checking ",E.length," streams\u2026"),a.a.createElement("div",{style:{display:"flex",flexWrap:"wrap"}},E.map((function(e){return a.a.createElement(L,{key:e.id,stream:e,gameName:g.get(e.game_id)})}))),a.a.createElement(u.a,{variant:"contained",size:"large",color:"primary",onClick:C,style:{position:"fixed",bottom:0}},"SHOW ME MOAR")))}function M(e){var t,n=new Map,r=Object(i.a)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;n.set(a.id,a)}}catch(c){r.e(c)}finally{r.f()}return Object(s.a)(n.values())}var D=function(){var e=W();return a.a.createElement("div",{className:"App"},e.hasAuth()?a.a.createElement(H,null):a.a.createElement(u.a,{color:"primary",variant:"contained",size:"large",href:e.getAuthUrl()},"Login"))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(D,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[54,1,2]]]);
//# sourceMappingURL=main.30910523.chunk.js.map